private macro for(e, f): (concat-map e f);

do
    let eff :=
        ~ for &(x) := emit* (range 0 10),
        ~ do println (str x),
            println '---',
    eff | catch* (&(_)(crash 'I/O Error'))
        | wait-complete;
