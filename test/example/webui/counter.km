do webui-init 'Counter' DOM;

do WebUi::ExitWhenWindowClosed;

private const ControlStyle: WebUi::Styles
    dom-styles [
        ('display', 'inline-block'),
        ('font-size', '24px'),
        ('min-width', '50px'),
        ('text-align', 'center')
    ];

private const DOM: NoExcept*[WebUi::Node]
    ~ then* &(@value) := new-latch (:Int: 0),
    let dec := dom-event-sink @value (&(value) (&(_) $(value - 1))),
    let inc := dom-event-sink @value (&(value) (&(_) $(value + 1))),
    ~ map* &(value) := @value.receive,
    let styles := ControlStyle,
    let dec-btn := (
        dom-node 'button' styles (dom-attrs []) (dom-event 'click' dec)
        (dom-text '-')
    ),
    let inc-btn := (
        dom-node 'button' styles (dom-attrs []) (dom-event 'click' inc)
        (dom-text '+')
    ),
    let label := (
        dom-node 'span' styles (dom-attrs []) (dom-events [])
        (dom-text (str value))
    ),
    dom-node 'div' [dec-btn, label, inc-btn];
