do ui-init 'Counter' DOM;

do UI::ExitWhenWindowClosed;

private const ControlStyle: UI::Styles
    dom-styles [
        ('display', 'inline-block'),
        ('font-size', '24px'),
        ('min-width', '50px'),
        ('text-align', 'center')
    ];

private const DOM: NoExcept*[UI::Node]
    ~ with-reactive* &(@value) := (:Int: 0),
    let dec := dom-event-sink @value (&(value) (&(_) $(value - 1))),
    let inc := dom-event-sink @value (&(value) (&(_) $(value + 1))),
    ~ map* &(value) := @value.watch,
    let styles := ControlStyle,
    let dec-btn := dom-node 'button' {
        content: (dom-text '-'), styles,
        events:  (dom-event 'click' dec)
    },
    let inc-btn := dom-node 'button' {
        content: (dom-text '+'), styles,
        events:  (dom-event 'click' inc)
    },
    let label := dom-node 'span' {
        content: (dom-text (str value)), styles
    },
    dom-node 'div' [dec-btn, label, inc-btn];
