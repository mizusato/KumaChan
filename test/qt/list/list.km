do (show Window);

do (listen (Window.closed))
    | concat-map (&(_)(exit 0))
    | forever;

do @state
    | map* ( & {list}
        list | map (& { id, label } (list-widget-item id label)))
    | concat-map (&(list)(TodoList.set-items list N/A))
    | forever;

do (listen (TodoList.current-item))
    | concat-map ( &(key?)
        switch key?:
        case Just key:
            println ("Current: #" key),
        case N/A:
            println 'Current N/A',
        end
    )
    | catch* (&(err)(crash err))
    | forever;
